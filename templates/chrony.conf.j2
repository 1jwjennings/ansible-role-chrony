# Generated by Ansible

{% for server in chrony_servers -%}
  server {{ server.name }}
  {%- for option in server.options -%}
    {%- if server.options[option] != False -%}
      {{ ' ' + option }}
      {%- if server.options[option] != True -%}
        {{ ' ' + server.options[option]|string }}
      {%- endif -%}
    {%- endif -%}
  {%- endfor %}

{% endfor -%}

{% for pool in chrony_pools -%}
  pool {{ pool.name }}
  {%- for option in pool.options -%}
    {%- if pool.options[option] != False -%}
      {{ ' ' + option }}
      {%- if pool.options[option] != True -%}
        {{ ' ' + pool.options[option]|string }}
      {%- endif -%}
    {%- endif -%}
  {%- endfor %}

{% endfor -%}

{% for peer in chrony_peers -%}
  peer {{ peer.name }}
  {%- for option in peer.options -%}
    {%- if peer.options[option] != False -%}
      {{ ' ' + option }}
      {%- if peer.options[option] != True -%}
        {{ ' ' + peer.options[option]|string }}
      {%- endif -%}
    {%- endif -%}
  {%- endfor %}

{% endfor -%}

{% if chrony_initstepslew -%}
  initstepslew {{ chrony_initstepslew.threshold + ' ' + chrony_initstepslew.hosts|join(' ') }}
{% endif -%}

{% for reflock in chrony_refclocks -%}
  refclock {{ refclock.driver }}
  {%- for opt in refclock.param_options -%}
    {{ ':' + opt }}
    {%- if refclock.param_options[opt] != True -%}
      {{ '=' + refclock.param_options[opt]|string }}
    {%- endif -%}
  {%- endfor %}

{% endfor -%}

{% for dir in chrony_sourcedirs -%}
  sourcedir {{ dir }}
{% endfor -%}

{% if chrony_driftfile -%}
  driftfile {{ chrony_driftfile }}
{% endif -%}

{% if chrony_makestep -%}
  makestep {{ chrony_makestep.threshold|string + ' ' + chrony_makestep.limit|string }}
{% endif -%}

{% if chrony_rtcsync -%}
  rtcsync
{% endif -%}

{% if chrony_local -%}
  local
  {%- for opt in chrony_local -%}
    {%- if chrony_local[opt] == True -%}
      {{ ' ' + opt }}
    {%- else -%}
      {{ ' ' + opt + ' ' + chrony_local[opt]|string }}
    {%- endif -%}
  {%- endfor %}

{% endif -%}

{% if chrony_keyfile -%}
  keyfile {{ chrony_keyfile }}
{% endif -%}

{% if chrony_ntsdumpdir -%}
  ntsdumpdir {{ chrony_ntsdumpdir }}
{% endif -%}

{% if chrony_leapsectz -%}
  leapsectz {{ chrony_leapsectz }}
{% endif -%}

{% if chrony_logdir -%}
  logdir {{ chrony_logdir }}
{% endif -%}