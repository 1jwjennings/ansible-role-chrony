# Generated by Ansible

{% if chrony_servers -%}
  {%- for server in chrony_servers -%}
    server {{ server.name }}
    {%- for option in server|difference('name') -%}
      {%- if server[option] is boolean -%}
        {%- if server[option] == True -%}
          {{ ' ' }}{{ option }}
        {%- endif -%}
      {%- else -%}
        {{ ' ' }}{{ option }} {{ server[option] }}
      {%- endif -%}
    {%- endfor -%}
    {{ '\n' }}
  {%- endfor -%}
{%- endif -%}

{% if chrony_pools -%}
  {%- for pool in chrony_pools -%}
    pool {{ pool.name }}
    {%- for option in pool|difference('name') -%}
      {%- if pool[option] is boolean -%}
        {%- if pool[option] == True -%}
          {{ ' ' }}{{ option }}
        {%- endif -%}
      {%- else -%}
        {{ ' ' }}{{ option }} {{ pool[option] }}
      {%- endif -%}
    {%- endfor -%}
    {{ '\n' }}
  {%- endfor -%}
{%- endif -%}

{% if chrony_peers -%}
  {%- for peer in chrony_peers -%}
    peer {{ peer.name }}
    {%- for option in peer|difference('name') -%}
      {%- if peer[option] is boolean -%}
        {%- if peer[option] == True -%}
          {{ ' ' }}{{ option }}
        {%- endif -%}
      {%- else -%}
        {{ ' ' }}{{ option }} {{ peer[option] }}
      {%- endif -%}
    {%- endfor -%}
    {{ '\n' }}
  {%- endfor -%}
{%- endif -%}

{% if chrony_initstepslew -%}
  initstepslew {{ chrony_initstepslew.threshold }} {{ chrony_initstepslew.hosts|join(' ') }}
{% endif -%}

{% if chrony_refclocks -%}
  {%- for refclock in chrony_refclocks -%}
    refclock {{ refclock.driver }}
    {%- if refclock.driver_options -%}
      {%- for opt in refclock.driver_options -%}
        {%- if refclock.driver_options[opt] is boolean -%}
          {%- if refclock.driver_options[opt] == True -%}
            {{ ':' }}{{ opt }}
          {%- endif -%}
        {%- else -%}
          {{ ':' }}{{ opt }}{{ '=' }}{{ refclock.driver_options[opt] }}
        {%- endif -%}
      {%- endfor -%}
    {%- endif -%}
    {%- if refclock.options -%}
      {%- for opt in refclock.options -%}
        {%- if refclock.options[opt] is boolean -%}
          {{ ' ' }}{{ opt }}
        {%- else -%}
          {{ ' ' }}{{ opt }} {{ refclock.options[opt] }}
        {%- endif -%}
      {%- endfor -%}
    {%- endif -%}
    {{ '\n' }}
  {%- endfor -%}
{%- endif -%}

{% for dir in chrony_sourcedirs -%}
  sourcedir {{ dir }}
{% endfor -%}

{% if chrony_driftfile -%}
  driftfile {{ chrony_driftfile }}
{% endif -%}

{% if chrony_makestep -%}
  makestep {{ chrony_makestep.threshold }} {{ chrony_makestep.limit }}
{% endif -%}

{% if chrony_rtcsync -%}
  rtcsync
{% endif -%}

{% if chrony_local -%}
  local
  {%- for opt in chrony_local -%}
    {%- if chrony_local[opt] is boolean -%}
      {%- if chrony_local[opt] == True -%}
        {{ ' ' }}{{ opt }}
      {%- endif -%}
    {%- else -%}
      {{ ' ' }}{{ opt }}{{ ' ' }}{{ chrony_local[opt] }}
    {%- endif -%}
  {%- endfor -%}
  {{ '\n' }}
{%- endif -%}

{% if chrony_keyfile -%}
  keyfile {{ chrony_keyfile }}
{% endif -%}

{% if chrony_ntsdumpdir -%}
  ntsdumpdir {{ chrony_ntsdumpdir }}
{% endif -%}

{% if chrony_leapsectz -%}
  leapsectz {{ chrony_leapsectz }}
{% endif -%}

{% if chrony_logdir -%}
  logdir {{ chrony_logdir }}
{% endif -%}

{% if chrony_log -%}
  log {{ chrony_log|join(' ') }}
{% endif -%}

{% if chrony_manual -%}
  manual
{% endif -%}

{% if chrony_acquisitionport -%}
  acquisitionport {{ chrony_acquisitionport }}
{% endif -%}

{% if chrony_bindacqaddress -%}
  bindacqaddress {{ chrony_bindacqaddress }}
{% endif -%}

{% if chrony_bindacqdevice -%}
  bindacqdevice {{ chrony_bindacqdevice }}
{% endif -%}

{% if chrony_dscp -%}
  dscp {{ chrony_dscp }}
{% endif -%}

{% if chrony_dumpdir -%}
  dumpdir {{ chrony_dumpdir }}
{% endif -%}

{% if chrony_maxsamples -%}
  maxsamples {{ chrony_maxsamples }}
{% endif -%}

{% if chrony_minsamples -%}
  minsamples {{ chrony_minsamples }}
{% endif -%}

{% if chrony_ntsaeads -%}
  ntsaeads {{ chrony_ntsaeads }}
{% endif -%}

{% if chrony_ntsrefresh -%}
  ntsrefresh {{ chrony_ntsrefresh }}
{% endif -%}

{%- if chrony_ntstrustedcerts -%}
  {%- for cert in chrony_ntstrustedcerts -%}
    ntstrustedcerts
    {%- if cert.id -%}
      {{ ' ' }}{{ cert.id }}
    {%- endif -%}
    {{ ' ' }}{{ cert.path }}{{ '\n' }}
  {%- endfor -%}
{%- endif -%}